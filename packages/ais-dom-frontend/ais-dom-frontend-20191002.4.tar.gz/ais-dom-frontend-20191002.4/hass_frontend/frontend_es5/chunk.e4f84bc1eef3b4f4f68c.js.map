{"version":3,"sources":["webpack:///./src/common/util/debounce.ts","webpack:///./src/common/string/compare.ts","webpack:///./src/data/config_flow.ts","webpack:///./src/dialogs/config-flow/show-dialog-data-entry-flow.ts","webpack:///./src/dialogs/config-flow/show-dialog-config-flow.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/data/core.ts","webpack:///./src/components/timezone-datalist.ts","webpack:///./src/components/map/ha-location-editor.ts","webpack:///./src/onboarding/onboarding-core-config.ts"],"names":["__webpack_require__","d","__webpack_exports__","debounce","func","wait","immediate","timeout","args","_i","arguments","length","context","this","callNow","clearTimeout","setTimeout","apply","compare","caseInsensitiveCompare","a","b","toLowerCase","createConfigFlow","hass","handler","callApi","fetchConfigFlow","flowId","handleConfigFlowStep","data","deleteConfigFlow","getConfigFlowHandlers","fetchConfigFlowInProgress","conn","sendMessagePromise","type","subscribeConfigFlowInProgressUpdates","store","subscribeEvents","Object","_common_util_debounce__WEBPACK_IMPORTED_MODULE_1__","then","flows","setState","getConfigFlowInProgressCollection","home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_2__","subscribeConfigFlowInProgress","onChange","connection","subscribe","localizeConfigFlowTitle","localize","flow","placeholders","title_placeholders","placeholderKeys","keys","forEach","key","push","tslib__WEBPACK_IMPORTED_MODULE_0__","loadDataEntryFlowDialog","Promise","all","e","bind","showFlowDialog","element","dialogParams","flowConfig","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_1__","dialogTag","dialogImport","loadConfigFlowDialog","_show_dialog_data_entry_flow__WEBPACK_IMPORTED_MODULE_4__","showConfigFlowDialog","loadDevicesAndAreas","getFlowHandlers","_data_config_flow__WEBPACK_IMPORTED_MODULE_1__","handlers","sort","handlerA","handlerB","_common_string_compare__WEBPACK_IMPORTED_MODULE_5__","createFlow","fetchFlow","handleFlowStep","deleteFlow","renderAbortDescription","step","description","_common_translations_localize__WEBPACK_IMPORTED_MODULE_3__","reason","description_placeholders","lit_element__WEBPACK_IMPORTED_MODULE_2__","templateObject_1","renderShowFormStepHeader","step_id","renderShowFormStepDescription","templateObject_2","renderShowFormStepFieldLabel","field","name","renderShowFormStepFieldError","error","renderExternalStepHeader","renderExternalStepDescription","templateObject_4","templateObject_3","renderCreateEntryDescription","templateObject_6","templateObject_5","title","setupLeafletMap","mapElement","darkMode","parentNode","Error","t","Leaflet","_a","sent","Icon","Default","imagePath","map","style","document","createElement","setAttribute","appendChild","setView","createTileLayer","addTo","leaflet","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","saveCoreConfig","values","callWS","detectCoreConfig","createTimezoneListEl","google_timezones_json__WEBPACK_IMPORTED_MODULE_0__","google_timezones_json__WEBPACK_IMPORTED_MODULE_0___default","n","list","id","option","value","innerHTML","_super","LocationEditor","_this","fitZoom","prototype","fitMap","_leafletMap","location","render","lit_element__WEBPACK_IMPORTED_MODULE_1__","firstUpdated","changedProps","call","_initMap","updated","_updateMarker","_ignoreFitToMap","undefined","defineProperty","shadowRoot","querySelector","_common_dom_setup_leaflet_map__WEBPACK_IMPORTED_MODULE_2__","_mapEl","_b","addEventListener","ev","_updateLocation","latlng","invalidateSize","lat","lng","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_3__","bubbles","_locationMarker","setLatLng","marker","draggable","target","getLatLng","addLayer","remove","amsterdam","OnboardingCoreConfig","_working","onboardingLocalize","user","_nameValue","_handleChange","_connectWifi","_detect","_locationValue","_locationChanged","_timeZoneValue","_elevationValue","_unitSystemValue","_unitSystemChanged","_save","focus","keyCode","inputElement","_components_timezone_datalist__WEBPACK_IMPORTED_MODULE_11__","_name","_location","_elevation","_timeZone","_unitSystem","currentTarget","detail","_data_core__WEBPACK_IMPORTED_MODULE_7__","latitude","longitude","Number","elevation","String","unit_system","time_zone","alert","err_1","message","result","_continueFlow","flow_id","_dialogs_config_flow_show_dialog_config_flow__WEBPACK_IMPORTED_MODULE_8__","continueFlowId","dialogClosedCallback","preventDefault","location_1","location_name","_data_onboarding__WEBPACK_IMPORTED_MODULE_9__","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_10__"],"mappings":"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","file":"chunk.e4f84bc1eef3b4f4f68c.js","sourcesContent":["// From: https://davidwalsh.name/javascript-debounce-function\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// tslint:disable-next-line: ban-types\nexport const debounce = <T extends Function>(\n  func: T,\n  wait,\n  immediate = false\n): T => {\n  let timeout;\n  // @ts-ignore\n  return function(...args) {\n    // tslint:disable:no-this-assignment\n    // @ts-ignore\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","import { HomeAssistant } from \"../types\";\nimport { DataEntryFlowStep, DataEntryFlowProgress } from \"./data_entry_flow\";\nimport { debounce } from \"../common/util/debounce\";\nimport { getCollection, Connection } from \"home-assistant-js-websocket\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\nexport const createConfigFlow = (hass: HomeAssistant, handler: string) =>\n  hass.callApi<DataEntryFlowStep>(\"POST\", \"config/config_entries/flow\", {\n    handler,\n  });\n\nexport const fetchConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi<DataEntryFlowStep>(\n    \"GET\",\n    `config/config_entries/flow/${flowId}`\n  );\n\nexport const handleConfigFlowStep = (\n  hass: HomeAssistant,\n  flowId: string,\n  data: { [key: string]: any }\n) =>\n  hass.callApi<DataEntryFlowStep>(\n    \"POST\",\n    `config/config_entries/flow/${flowId}`,\n    data\n  );\n\nexport const deleteConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi(\"DELETE\", `config/config_entries/flow/${flowId}`);\n\nexport const getConfigFlowHandlers = (hass: HomeAssistant) =>\n  hass.callApi<string[]>(\"GET\", \"config/config_entries/flow_handlers\");\n\nconst fetchConfigFlowInProgress = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config_entries/flow/progress\",\n  });\n\nconst subscribeConfigFlowInProgressUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchConfigFlowInProgress(conn).then((flows) =>\n          store.setState(flows, true)\n        ),\n      500,\n      true\n    ),\n    \"config_entry_discovered\"\n  );\n\nexport const getConfigFlowInProgressCollection = (conn: Connection) =>\n  getCollection<DataEntryFlowProgress[]>(\n    conn,\n    \"_configFlowProgress\",\n    fetchConfigFlowInProgress,\n    subscribeConfigFlowInProgressUpdates\n  );\n\nexport const subscribeConfigFlowInProgress = (\n  hass: HomeAssistant,\n  onChange: (flows: DataEntryFlowProgress[]) => void\n) => getConfigFlowInProgressCollection(hass.connection).subscribe(onChange);\n\nexport const localizeConfigFlowTitle = (\n  localize: LocalizeFunc,\n  flow: DataEntryFlowProgress\n) => {\n  const placeholders = flow.context.title_placeholders || {};\n  const placeholderKeys = Object.keys(placeholders);\n  if (placeholderKeys.length === 0) {\n    return localize(`component.${flow.handler}.config.title`);\n  }\n  const args: string[] = [];\n  placeholderKeys.forEach((key) => {\n    args.push(key);\n    args.push(placeholders[key]);\n  });\n  return localize(`component.${flow.handler}.config.flow_title`, ...args);\n};\n","import { TemplateResult } from \"lit-html\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../types\";\nimport {\n  DataEntryFlowStepCreateEntry,\n  DataEntryFlowStepExternal,\n  DataEntryFlowStepForm,\n  DataEntryFlowStep,\n  DataEntryFlowStepAbort,\n  FieldSchema,\n} from \"../../data/data_entry_flow\";\n\nexport interface FlowConfig {\n  loadDevicesAndAreas: boolean;\n\n  getFlowHandlers?: (hass: HomeAssistant) => Promise<string[]>;\n\n  createFlow(hass: HomeAssistant, handler: string): Promise<DataEntryFlowStep>;\n\n  fetchFlow(hass: HomeAssistant, flowId: string): Promise<DataEntryFlowStep>;\n\n  handleFlowStep(\n    hass: HomeAssistant,\n    flowId: string,\n    data: { [key: string]: any }\n  ): Promise<DataEntryFlowStep>;\n\n  deleteFlow(hass: HomeAssistant, flowId: string): Promise<unknown>;\n\n  renderAbortDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepAbort\n  ): TemplateResult | \"\";\n\n  renderShowFormStepHeader(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm\n  ): string;\n\n  renderShowFormStepDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm\n  ): TemplateResult | \"\";\n\n  renderShowFormStepFieldLabel(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm,\n    field: FieldSchema\n  ): string;\n\n  renderShowFormStepFieldError(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepForm,\n    error: string\n  ): string;\n\n  renderExternalStepHeader(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepExternal\n  ): string;\n\n  renderExternalStepDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepExternal\n  ): TemplateResult | \"\";\n\n  renderCreateEntryDescription(\n    hass: HomeAssistant,\n    step: DataEntryFlowStepCreateEntry\n  ): TemplateResult | \"\";\n}\n\nexport interface DataEntryFlowDialogParams {\n  startFlowHandler?: string;\n  continueFlowId?: string;\n  dialogClosedCallback?: (params: { flowFinished: boolean }) => void;\n  flowConfig: FlowConfig;\n}\n\nexport const loadDataEntryFlowDialog = () =>\n  import(/* webpackChunkName: \"dialog-config-flow\" */ \"./dialog-data-entry-flow\");\n\nexport const showFlowDialog = (\n  element: HTMLElement,\n  dialogParams: Omit<DataEntryFlowDialogParams, \"flowConfig\">,\n  flowConfig: FlowConfig\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"dialog-data-entry-flow\",\n    dialogImport: loadDataEntryFlowDialog,\n    dialogParams: {\n      ...dialogParams,\n      flowConfig,\n    },\n  });\n};\n","import {\n  getConfigFlowHandlers,\n  fetchConfigFlow,\n  handleConfigFlowStep,\n  deleteConfigFlow,\n  createConfigFlow,\n} from \"../../data/config_flow\";\nimport { html } from \"lit-element\";\nimport { localizeKey } from \"../../common/translations/localize\";\nimport {\n  showFlowDialog,\n  DataEntryFlowDialogParams,\n  loadDataEntryFlowDialog,\n} from \"./show-dialog-data-entry-flow\";\nimport { caseInsensitiveCompare } from \"../../common/string/compare\";\n\nexport const loadConfigFlowDialog = loadDataEntryFlowDialog;\n\nexport const showConfigFlowDialog = (\n  element: HTMLElement,\n  dialogParams: Omit<DataEntryFlowDialogParams, \"flowConfig\">\n): void =>\n  showFlowDialog(element, dialogParams, {\n    loadDevicesAndAreas: true,\n    getFlowHandlers: (hass) =>\n      getConfigFlowHandlers(hass).then((handlers) =>\n        handlers.sort((handlerA, handlerB) =>\n          caseInsensitiveCompare(\n            hass.localize(`component.${handlerA}.config.title`),\n            hass.localize(`component.${handlerB}.config.title`)\n          )\n        )\n      ),\n    createFlow: createConfigFlow,\n    fetchFlow: fetchConfigFlow,\n    handleFlowStep: handleConfigFlowStep,\n    deleteFlow: deleteConfigFlow,\n\n    renderAbortDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.abort.${step.reason}`,\n        step.description_placeholders\n      );\n\n      return description\n        ? html`\n            <ha-markdown allowsvg .content=${description}></ha-markdown>\n          `\n        : \"\";\n    },\n\n    renderShowFormStepHeader(hass, step) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.title`\n      );\n    },\n\n    renderShowFormStepDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.step.${step.step_id}.description`,\n        step.description_placeholders\n      );\n      return description\n        ? html`\n            <ha-markdown allowsvg .content=${description}></ha-markdown>\n          `\n        : \"\";\n    },\n\n    renderShowFormStepFieldLabel(hass, step, field) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.data.${\n          field.name\n        }`\n      );\n    },\n\n    renderShowFormStepFieldError(hass, step, error) {\n      return hass.localize(`component.${step.handler}.config.error.${error}`);\n    },\n\n    renderExternalStepHeader(hass, step) {\n      return hass.localize(\n        `component.${step.handler}.config.step.${step.step_id}.title`\n      );\n    },\n\n    renderExternalStepDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.${step.step_id}.description`,\n        step.description_placeholders\n      );\n\n      return html`\n        <p>\n          ${hass.localize(\n            \"ui.panel.config.integrations.config_flow.external_step.description\"\n          )}\n        </p>\n        ${description\n          ? html`\n              <ha-markdown allowsvg .content=${description}></ha-markdown>\n            `\n          : \"\"}\n      `;\n    },\n\n    renderCreateEntryDescription(hass, step) {\n      const description = localizeKey(\n        hass.localize,\n        `component.${step.handler}.config.create_entry.${step.description ||\n          \"default\"}`,\n        step.description_placeholders\n      );\n\n      return html`\n        ${description\n          ? html`\n              <ha-markdown allowsvg .content=${description}></ha-markdown>\n            `\n          : \"\"}\n        <p>Created config for ${step.title}.</p>\n      `;\n    },\n  });\n","import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement,\n  darkMode = false\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // tslint:disable-next-line\n  const Leaflet = (await import(/* webpackChunkName: \"leaflet\" */ \"leaflet\")) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  createTileLayer(Leaflet, darkMode).addTo(map);\n\n  return [map, Leaflet];\n};\n\nexport const createTileLayer = (\n  leaflet: LeafletModuleType,\n  darkMode: boolean\n) => {\n  return leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/${\n      darkMode ? \"dark_all\" : \"light_all\"\n    }/{z}/{x}/{y}${leaflet.Browser.retina ? \"@2x.png\" : \".png\"}`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  );\n};\n","import { HomeAssistant } from \"../types\";\nimport { HassConfig } from \"home-assistant-js-websocket\";\n\nexport interface ConfigUpdateValues {\n  location_name: string;\n  latitude: number;\n  longitude: number;\n  elevation: number;\n  unit_system: \"metric\" | \"imperial\";\n  time_zone: string;\n}\n\nexport const saveCoreConfig = (\n  hass: HomeAssistant,\n  values: Partial<ConfigUpdateValues>\n) =>\n  hass.callWS<HassConfig>({\n    type: \"config/core/update\",\n    ...values,\n  });\n\nexport const detectCoreConfig = (hass: HomeAssistant) =>\n  hass.callWS<Partial<ConfigUpdateValues>>({\n    type: \"config/core/detect\",\n  });\n","import timezones from \"google-timezones-json\";\n\nexport const createTimezoneListEl = () => {\n  const list = document.createElement(\"datalist\");\n  list.id = \"timezones\";\n  Object.keys(timezones).forEach((key) => {\n    const option = document.createElement(\"option\");\n    option.value = key;\n    option.innerHTML = timezones[key];\n    list.appendChild(option);\n  });\n  return list;\n};\n","import {\n  LitElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { Marker, Map, LeafletMouseEvent, DragEndEvent, LatLng } from \"leaflet\";\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../common/dom/setup-leaflet-map\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\n\n@customElement(\"ha-location-editor\")\nclass LocationEditor extends LitElement {\n  @property() public location?: [number, number];\n  public fitZoom = 16;\n\n  private _ignoreFitToMap?: [number, number];\n\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  private _locationMarker?: Marker;\n\n  public fitMap(): void {\n    if (!this._leafletMap || !this.location) {\n      return;\n    }\n    this._leafletMap.setView(this.location, this.fitZoom);\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      <div id=\"map\"></div>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this._initMap();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    // Still loading.\n    if (!this.Leaflet) {\n      return;\n    }\n\n    this._updateMarker();\n    if (!this._ignoreFitToMap || this._ignoreFitToMap !== this.location) {\n      this.fitMap();\n    }\n    this._ignoreFitToMap = undefined;\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.querySelector(\"div\")!;\n  }\n\n  private async _initMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(this._mapEl);\n    this._leafletMap.addEventListener(\n      \"click\",\n      // @ts-ignore\n      (ev: LeafletMouseEvent) => this._updateLocation(ev.latlng)\n    );\n    this._updateMarker();\n    this.fitMap();\n    this._leafletMap.invalidateSize();\n  }\n\n  private _updateLocation(latlng: LatLng) {\n    this.location = this._ignoreFitToMap = [latlng.lat, latlng.lng];\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _updateMarker(): void {\n    if (!this.location) {\n      if (this._locationMarker) {\n        this._locationMarker.remove();\n        this._locationMarker = undefined;\n      }\n      return;\n    }\n\n    if (this._locationMarker) {\n      this._locationMarker.setLatLng(this.location);\n      return;\n    }\n    this._locationMarker = this.Leaflet!.marker(this.location, {\n      draggable: true,\n    });\n    this._locationMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._updateLocation(ev.target.getLatLng())\n    );\n    this._leafletMap!.addLayer(this._locationMarker);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-location-editor\": LocationEditor;\n  }\n}\n","import {\n  LitElement,\n  customElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button/mwc-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-radio-group/paper-radio-group\";\nimport \"@polymer/paper-radio-button/paper-radio-button\";\nimport \"@polymer/paper-listbox/paper-listbox\";\n// tslint:disable-next-line: no-duplicate-imports\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport { HomeAssistant } from \"../types\";\nimport {\n  ConfigUpdateValues,\n  detectCoreConfig,\n  saveCoreConfig,\n} from \"../data/core\";\nimport { showConfigFlowDialog } from \"../dialogs/config-flow/show-dialog-config-flow\";\nimport { PolymerChangedEvent } from \"../polymer-types\";\nimport { onboardCoreConfigStep } from \"../data/onboarding\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\nimport { createTimezoneListEl } from \"../components/timezone-datalist\";\nimport \"../components/map/ha-location-editor\";\n\nconst amsterdam = [52.3731339, 4.8903147];\n\n@customElement(\"onboarding-core-config\")\nclass OnboardingCoreConfig extends LitElement {\n  @property() public hass!: HomeAssistant;\n  @property() public onboardingLocalize!: LocalizeFunc;\n\n  @property() private _working = false;\n\n  @property() private _name!: ConfigUpdateValues[\"location_name\"];\n  @property() private _location!: [number, number];\n  @property() private _elevation!: string;\n  @property() private _unitSystem!: ConfigUpdateValues[\"unit_system\"];\n  @property() private _timeZone!: string;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <p>\n        ${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.intro\",\n          \"name\",\n          this.hass.user!.name\n        )}\n      </p>\n\n      <paper-input\n        .label=${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name\"\n        )}\n        name=\"name\"\n        .disabled=${this._working}\n        .value=${this._nameValue}\n        @value-changed=${this._handleChange}\n      ></paper-input>\n\n      <div class=\"middle-text\">\n        <p>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.intro_location\"\n          )}\n        </p>\n        <div class=\"row\">\n          <div>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.intro_location_detect\"\n            )}\n            Do tego jest potrzebne połączenie z Internetem.\n          </div>\n          <mwc-button @click=${this._connectWifi}>\n            POŁĄCZ Z WIFI\n          </mwc-button>\n        </div>\n\n        <div class=\"row\">\n          <div>\n            Ustal swoją lokalizację po adresie IP wysyłając jednorazowe\n            zapytanie do serwisu\n            <span\n              style=\"color:#FF9800; font-weight: bold;\"\n              @click=${this._detect}\n              >ipapi.co</span\n            >\n          </div>\n          <mwc-button @click=${this._detect}>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.button_detect\"\n            )}\n          </mwc-button>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <ha-location-editor\n          class=\"flex\"\n          .location=${this._locationValue}\n          .fitZoom=${14}\n          @change=${this._locationChanged}\n          style=\"z-index:100\"\n        ></ha-location-editor>\n      </div>\n\n      <div class=\"row\">\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.time_zone\"\n          )}\n          name=\"timeZone\"\n          list=\"timezones\"\n          .disabled=${this._working}\n          .value=${this._timeZoneValue}\n          @value-changed=${this._handleChange}\n        ></paper-input>\n\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.elevation\"\n          )}\n          name=\"elevation\"\n          type=\"number\"\n          .disabled=${this._working}\n          .value=${this._elevationValue}\n          @value-changed=${this._handleChange}\n        >\n          <span slot=\"suffix\">\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.elevation_meters\"\n            )}\n          </span>\n        </paper-input>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"flex\">\n          ${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.unit_system\"\n          )}\n        </div>\n        <paper-radio-group\n          class=\"flex\"\n          .selected=${this._unitSystemValue}\n          @selected-changed=${this._unitSystemChanged}\n        >\n          <paper-radio-button name=\"metric\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_metric\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.metric_example\"\n              )}\n            </div>\n          </paper-radio-button>\n          <paper-radio-button name=\"imperial\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_imperial\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.imperial_example\"\n              )}\n            </div>\n          </paper-radio-button>\n        </paper-radio-group>\n      </div>\n\n      <div class=\"footer\">\n        <mwc-button @click=${this._save} .disabled=${this._working}>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.finish\"\n          )}\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    setTimeout(\n      () => this.shadowRoot!.querySelector(\"paper-input\")!.focus(),\n      100\n    );\n    this.addEventListener(\"keypress\", (ev) => {\n      if (ev.keyCode === 13) {\n        this._save(ev);\n      }\n    });\n    const input = this.shadowRoot!.querySelector(\n      \"[name=timeZone]\"\n    ) as PaperInputElement;\n    input.inputElement.appendChild(createTimezoneListEl());\n  }\n\n  private get _nameValue() {\n    return this._name !== undefined\n      ? this._name\n      : this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name_default\"\n        );\n  }\n\n  private get _locationValue() {\n    return this._location || amsterdam;\n  }\n\n  private get _elevationValue() {\n    return this._elevation !== undefined ? this._elevation : 0;\n  }\n\n  private get _timeZoneValue() {\n    return this._timeZone;\n  }\n\n  private get _unitSystemValue() {\n    return this._unitSystem !== undefined ? this._unitSystem : \"metric\";\n  }\n\n  private _handleChange(ev: PolymerChangedEvent<string>) {\n    const target = ev.currentTarget as PaperInputElement;\n    this[`_${target.name}`] = target.value;\n  }\n\n  private _locationChanged(ev) {\n    this._location = ev.currentTarget.location;\n  }\n\n  private _unitSystemChanged(\n    ev: PolymerChangedEvent<ConfigUpdateValues[\"unit_system\"]>\n  ) {\n    this._unitSystem = ev.detail.value;\n  }\n\n  private async _detect() {\n    this._working = true;\n    try {\n      const values = await detectCoreConfig(this.hass);\n      if (values.latitude && values.longitude) {\n        this._location = [Number(values.latitude), Number(values.longitude)];\n      }\n      if (values.elevation) {\n        this._elevation = String(values.elevation);\n      }\n      if (values.unit_system) {\n        this._unitSystem = values.unit_system;\n      }\n      if (values.time_zone) {\n        this._timeZone = values.time_zone;\n      }\n    } catch (err) {\n      alert(`Failed to detect location information: ${err.message}`);\n    } finally {\n      this._working = false;\n    }\n  }\n\n  private _connectWifi() {\n    this.hass\n      .callApi(\"POST\", \"config/config_entries/flow\", {\n        handler: \"ais_wifi_service\",\n      })\n      .then((result: any) => {\n        this._continueFlow(result.flow_id);\n      });\n  }\n\n  private _continueFlow(flowId) {\n    showConfigFlowDialog(this, {\n      continueFlowId: flowId,\n      dialogClosedCallback: () => {\n        return;\n      },\n    });\n  }\n\n  private async _save(ev) {\n    ev.preventDefault();\n    this._working = true;\n    try {\n      const location = this._locationValue;\n      await saveCoreConfig(this.hass, {\n        location_name: this._nameValue,\n        latitude: location[0],\n        longitude: location[1],\n        elevation: Number(this._elevationValue),\n        unit_system: this._unitSystemValue,\n        time_zone: this._timeZoneValue || \"UTC\",\n      });\n      const result = await onboardCoreConfigStep(this.hass);\n      fireEvent(this, \"onboarding-step\", {\n        type: \"core_config\",\n        result,\n      });\n    } catch (err) {\n      this._working = false;\n      alert(\"FAIL\");\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .row {\n        display: flex;\n        flex-direction: row;\n        margin: 0 -8px;\n        align-items: center;\n      }\n\n      .secondary {\n        color: var(--secondary-text-color);\n      }\n\n      .flex {\n        flex: 1;\n      }\n\n      .middle-text {\n        margin: 24px 0;\n      }\n\n      .row > * {\n        margin: 0 8px;\n      }\n      .footer {\n        margin-top: 16px;\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"onboarding-core-config\": OnboardingCoreConfig;\n  }\n}\n"],"sourceRoot":""}