

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Presenting videos in Expyriment &mdash; Expyriment 0.10.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Expyriment plugin system (extras)" href="Plugins.html" />
    <link rel="prev" title="Using fonts" href="Fonts.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Expyriment
          

          
            
            <img src="_static/xpy_button.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Advanced.html">Advanced</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="APIReferenceTool.html">API reference tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="Testsuite.html">Test suite</a></li>
<li class="toctree-l2"><a class="reference internal" href="CommandLineInterface.html">Command line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataPreprocessing.html">Data preprocessing and exporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unicode.html">Using non-English characters</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fonts.html">Using fonts</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Presenting videos</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plugins.html">Plugin system (extras)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Defaults.html">Defaults (settings)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Hardware.html">Hardware compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="Timing.html">Timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="Problems.html">Problems &amp; Limitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="expyriment.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="PreviousVersions.html">Previous versions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Expyriment</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Advanced.html">Advanced</a> &raquo;</li>
        
      <li>Presenting videos in Expyriment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="presenting-videos-in-expyriment">
<h1>Presenting videos in Expyriment<a class="headerlink" href="#presenting-videos-in-expyriment" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-formats">
<h2>Video formats<a class="headerlink" href="#video-formats" title="Permalink to this headline">¶</a></h2>
<p>Since version 0.9.0 Expyriment uses FFMPEG (<a class="reference external" href="https://www.ffmpeg.org">https://www.ffmpeg.org</a>) by default to decode video files (the <code class="docutils literal notranslate"><span class="pre">mediadecoder</span></code> backend) if enhanced video playback support has been installed (see <a class="reference internal" href="Installation.html"><span class="doc">Installation</span></a>). This means that a large variety of video formats are automatically supported.</p>
<p>The old video backend is still available as <code class="docutils literal notranslate"><span class="pre">pygame</span></code>, and only plays MPEG1 videos with MP3 audio.
If you have to use the old backend, you can encode any video into this correct format using FFMPEG directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ffmpeg</span> <span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span><span class="n">inputfile</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">vcodec</span> <span class="n">mpeg1video</span> <span class="o">-</span><span class="n">acodec</span> <span class="n">libmp3lame</span> <span class="o">-</span><span class="n">intra</span> <span class="o">-</span><span class="n">qscale</span> <span class="mi">2</span>  <span class="o">&lt;</span><span class="n">outputfile</span><span class="o">.</span><span class="n">mpg</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-qscale</span></code> option is the quality setting. It can take values from 1 to 31. 1 is the best quality, but big file size. 31 is the worst quality, but small file size. Play around with this setting to get a good balance between quality and file size.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Create a video object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_video</span> <span class="o">=</span> <span class="n">expyriment</span><span class="o">.</span><span class="n">stimuli</span><span class="o">.</span><span class="n">Video</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">If the video has sound, then the audio system has to be stopped (temporarily), such that the video system can play sound):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expyriment</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">stop_audiosystem</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Preload the video into memory, before playing it back:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_video</span><span class="o">.</span><span class="n">preload</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">To actually present the video on screen, understanding the various methods of the video object is crucial:</p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">play()</span></code></dt><dd><p>will simply start video (and audio) playback in the background. This has no effect on the screen, no frames from the video are presented automatically.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">present()</span></code></dt><dd><p>waits for a new frame, then presents this frame on the screen. The method blocks until the new frame has been presented on the screen (if in OpenGL mode).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">update()</span></code></dt><dd><p>presents the currently available frame immediately (i.e. without waiting for a new one). The methods blocks until the currently available frame has been presented on the screen (if in OpenGL mode).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">wait_end()</span></code></dt><dd><p>continuously presents frames until the last frame of the video is reached. Dropped frames will be reported (in the terminal as well as in the event file). The keyboard is monitored during this, such that hitting ESC will pause playback, and then choosing “n” will resume it (while choosing “y” will quit of course).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">wait_frame()</span></code></dt><dd><p>behaves like <code class="docutils literal notranslate"><span class="pre">wait_end()</span></code>, with the difference that it waits until frame number <cite>frame</cite> instead of the last frame.</p>
</dd>
</dl>
<p>The perhaps most common situation is thus to use a combination of <code class="docutils literal notranslate"><span class="pre">play()</span></code>, <code class="docutils literal notranslate"><span class="pre">present()</span></code> and <code class="docutils literal notranslate"><span class="pre">wait_end()</span></code>.</p>
</li>
<li><p class="first">When done, delete the video stimulus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">my_video</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Simple example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">expyriment</span> <span class="k">as</span> <span class="nn">xpy</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">xpy</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">xpy</span><span class="o">.</span><span class="n">stimuli</span><span class="o">.</span><span class="n">Video</span><span class="p">(</span><span class="s2">&quot;file.mpg&quot;</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">preload</span><span class="p">()</span>

<span class="n">v</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">present</span><span class="p">()</span>
<span class="n">video_presentation_time</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">time</span>
<span class="n">v</span><span class="o">.</span><span class="n">wait_end</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>If key presses (other than the control keys) need to be checked during the video playback:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">expyriment</span> <span class="k">as</span> <span class="nn">xpy</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">xpy</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">xpy</span><span class="o">.</span><span class="n">stimuli</span><span class="o">.</span><span class="n">Video</span><span class="p">(</span><span class="s2">&quot;file.mpg&quot;</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">preload</span><span class="p">()</span>

<span class="n">v</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">present</span><span class="p">()</span>
<span class="n">video_presentation_time</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">time</span>
<span class="k">while</span> <span class="n">v</span><span class="o">.</span><span class="n">is_playing</span><span class="p">:</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">new_frame_available</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">keyboard</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="n">xpy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">K_SPACE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">key_pressed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">v</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Do not infer reaction times from this!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Plugins.html" class="btn btn-neutral float-right" title="The Expyriment plugin system (extras)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Fonts.html" class="btn btn-neutral float-left" title="Using fonts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Florian Krause &amp; Oliver Lindemann

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>