(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{110:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(14),l=a.n(o),c=(a(85),a(12)),s=a(8),i=a(20),m=a(21),p=a(22),u=a(145),d=a(38),h=a(10),f=a(44),g=a.n(f),b=a(56),y=a(142),v=a(26),E=a.n(v),O=a(27),j=a.n(O),N=a(137),k=a(138),x=a(140),w=a(141),C=a(139),S=a(116),W=a(65),B=a.n(W),M=a(66),D=a.n(M),I=a(43),P=a.n(I),L=a(25),A=a(35),F=a(143),R=a(144),_=a(51),T=a.n(_),H=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.lines;return r.a.createElement(N.a,null,r.a.createElement(k.a,null,a.map(function(e,a){return r.a.createElement(C.a,{key:a},r.a.createElement(x.a,{className:P()(t.cell,t.lineNumber),"data-line-number":a+1}),r.a.createElement(x.a,{className:P()(t.cell,t.line)},e))})))}}]),t}(r.a.Component),U=j()(function(e){return E()({root:{overflowX:"auto"},cell:{borderWidth:0,fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",padding:0,"&:last-child":{paddingRight:0}},lineNumber:{color:e.palette.text.secondary,paddingRight:e.spacing(2),textAlign:"right",verticalAlign:"top",width:"1%","&::before":{content:"attr(data-line-number)"}},line:{textAlign:"left",whiteSpace:"pre-wrap"}})})(H),V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleClose=function(){a.props.history.push("/")},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){for(var e=this.props,t=e.classes,a=e.errors,n=e.match.params,o=n.hostname,l=n.pid,c={},s=0,i=Object.values(a);s<i.length;s++){var m=i[s],p=!0,u=!1,d=void 0;try{for(var f,g=m[Symbol.iterator]();!(p=(f=g.next()).done);p=!0){var b=f.value,y=b.message.match(/\(pid=(\d+), host=(.*?)\)/);if(null!==y&&y[2]===o){var v=y[1];v in c||(c[v]=[]),c[v].push({lines:b.message.replace(/\u001b\[\d+m/g,"").trim().split("\n"),timestamp:b.timestamp})}}}catch(O){u=!0,d=O}finally{try{p||null==g.return||g.return()}finally{if(u)throw d}}}var E=void 0===l?c:Object(h.a)({},l,l in c?c[l]:[]);return r.a.createElement(F.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:this.handleClose,open:!0,scroll:"body"},r.a.createElement(R.a,{className:t.closeButton,onClick:this.handleClose},r.a.createElement(T.a,null)),Object.entries(E).map(function(e){var a=Object(A.a)(e,2),n=a[0],l=a[1];return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(S.a,{className:t.title},o," (PID: ",n,")"),l.length>0?l.map(function(e,a){var n=e.lines,o=e.timestamp;return r.a.createElement("div",{className:t.error,key:a},r.a.createElement(S.a,{className:t.timestamp},"Error at ",new Date(1e3*o).toLocaleString()),r.a.createElement(U,{lines:n}))}):r.a.createElement(S.a,{color:"textSecondary"},"No errors found."))}))}}]),t}(r.a.Component),z=j()(function(e){return E()({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3),position:"relative","&:not(:first-of-type)":{marginTop:e.spacing(6)}},error:{"&:not(:last-child)":{marginBottom:e.spacing(3)}},timestamp:{marginBottom:e.spacing(1)}})})(V),J=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleClose=function(){a.props.history.push("/")},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){for(var e=this.props,t=e.classes,a=e.ipToHostname,n=e.logs,o=e.match.params,l=o.hostname,c=o.pid,s={},i=0,m=Object.keys(a);i<m.length;i++){var p=m[i];if(a[p]===l){p in n&&(s=n[p]);break}}var u=void 0===c?s:Object(h.a)({},c,c in s?s[c]:[]);return r.a.createElement(F.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:this.handleClose,open:!0,scroll:"body"},r.a.createElement(R.a,{className:t.closeButton,onClick:this.handleClose},r.a.createElement(T.a,null)),Object.entries(u).map(function(e){var a=Object(A.a)(e,2),n=a[0],o=a[1];return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(S.a,{className:t.title},l," (PID: ",n,")"),o.length>0?r.a.createElement(U,{lines:o}):r.a.createElement(S.a,{color:"textSecondary"},"No logs found."))}))}}]),t}(r.a.Component),G=j()(function(e){return E()({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3),position:"relative","&:not(:first-of-type)":{marginTop:e.spacing(3)}}})})(J),X=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.text,n=this.props.percent;n=Math.max(n,0);var o=[0,255,0],l=o,c=function(e,t,a){var n=Object(A.a)(e,3),r=n[0],o=n[1],l=n[2],c=Object(A.a)(t,3);return[r*(1-a)+c[0]*a,o*(1-a)+c[1]*a,l*(1-a)+c[2]*a]}(o,[255,0,0],(n=Math.min(n,100))/100),s="\n      linear-gradient(\n        to right,\n        rgba(".concat(l.join(","),", ").concat(.2,") 0%,\n        rgba(").concat(c.join(","),", ").concat(.2,") ").concat(n,"%,\n        transparent ").concat(n,"%\n      )\n    ");return r.a.createElement("div",{className:t.root},r.a.createElement("div",{style:{background:s}},a))}}]),t}(r.a.Component),q=j()(function(e){return E()({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1}})})(X);function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Y=function(e,t){return"".concat((e/("mebibyte"===t?Math.pow(1024,2):Math.pow(1024,3))).toFixed(1)," ").concat("mebibyte"===t?"MiB":"GiB")},Z=function(e,t,a){var n=Y(e,a),r=Y(t,a),o=100*e/t;return"".concat(n," / ").concat(r," (").concat(o.toFixed(0),"%)")},$=function(e){var t=Date.now()/1e3-e,a=Math.floor(t)%60,n=Math.floor(t/60)%60,r=Math.floor(t/60/60)%24,o=Math.floor(t/60/60/24),l=function(e){return e.toString().padStart(2,"0")};return[o?"".concat(o,"d"):"","".concat(l(r),"h"),"".concat(l(n),"m"),"".concat(l(a),"s")].join(" ")},ee=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={response:null,error:null,expanded:{}},a.fetchNodeInfo=Object(b.a)(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new URL("/api/node_info",window.location.href),e.next=4,fetch(t.toString());case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,a.setState({response:r,error:null}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),a.setState({response:null,error:e.t0.toString()});case 14:return e.prev=14,setTimeout(a.fetchNodeInfo,1e3),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[0,11,14,17]])})),a.toggleExpand=function(e){return function(){a.setState(function(t){return{expanded:Q({},t.expanded,Object(h.a)({},e,!t.expanded[e]))}})}},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchNodeInfo();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.response,o=a.error,l=a.expanded;if(null!==o)return r.a.createElement(S.a,{className:t.root,color:"error"},o);if(null===n)return r.a.createElement(S.a,{className:t.root,color:"textSecondary"},"Loading...");var c=n.result,s=n.timestamp,i={},m={},p=!0,u=!1,h=void 0;try{for(var f,g=c.clients[Symbol.iterator]();!(p=(f=g.next()).done);p=!0){var b=f.value;i[b.hostname]={perWorker:{},total:0},m[b.hostname]={perWorker:{},total:0};var v=!0,E=!1,O=void 0;try{for(var j,W=b.workers[Symbol.iterator]();!(v=(j=W.next()).done);v=!0){var M=j.value;i[b.hostname].perWorker[M.pid]=0,m[b.hostname].perWorker[M.pid]=0}}catch(ve){E=!0,O=ve}finally{try{v||null==W.return||W.return()}finally{if(E)throw O}}}}catch(ve){u=!0,h=ve}finally{try{p||null==g.return||g.return()}finally{if(u)throw h}}for(var I=0,A=Object.keys(c.logs);I<A.length;I++){var F=A[I],R=null,_=!0,T=!1,H=void 0;try{for(var U,V=c.clients[Symbol.iterator]();!(_=(U=V.next()).done);_=!0){var J=U.value;if(F===J.ip){R=J.hostname;break}}}catch(ve){T=!0,H=ve}finally{try{_||null==V.return||V.return()}finally{if(T)throw H}}if(null!==R)for(var X=0,K=Object.keys(c.logs[F]);X<K.length;X++){var Q=K[X],ee=c.logs[F][Q].length;Q in i[R].perWorker&&(i[R].perWorker[Q]=ee),i[R].total+=ee}}for(var te=0,ae=Object.values(c.errors);te<ae.length;te++){var ne=ae[te],re=!0,oe=!1,le=void 0;try{for(var ce,se=ne[Symbol.iterator]();!(re=(ce=se.next()).done);re=!0){var ie=ce.value.message.match(/\(pid=(\d+), host=(.*?)\)/);if(null!==ie){var me=ie[1],pe=ie[2];pe in m&&(me in m[pe].perWorker&&m[pe].perWorker[me]++,m[pe].total++)}}}catch(ve){oe=!0,le=ve}finally{try{re||null==se.return||se.return()}finally{if(oe)throw le}}}var ue={},de=!0,he=!1,fe=void 0;try{for(var ge,be=c.clients[Symbol.iterator]();!(de=(ge=be.next()).done);de=!0){var ye=ge.value;ue[ye.ip]=ye.hostname}}catch(ve){he=!0,fe=ve}finally{try{de||null==be.return||be.return()}finally{if(he)throw fe}}return r.a.createElement("div",{className:t.root},r.a.createElement(S.a,{variant:"h5"},"Ray Dashboard"),r.a.createElement(N.a,null,r.a.createElement(w.a,null,r.a.createElement(C.a,null,r.a.createElement(x.a,{className:t.cell}),r.a.createElement(x.a,{className:t.cell},"Hostname"),r.a.createElement(x.a,{className:t.cell},"Workers"),r.a.createElement(x.a,{className:t.cell},"Uptime"),r.a.createElement(x.a,{className:t.cell},"CPU"),r.a.createElement(x.a,{className:t.cell},"RAM"),r.a.createElement(x.a,{className:t.cell},"Disk"),r.a.createElement(x.a,{className:t.cell},"Logs"),r.a.createElement(x.a,{className:t.cell},"Errors"))),r.a.createElement(k.a,null,c.clients.map(function(a){return r.a.createElement(r.a.Fragment,{key:a.hostname},r.a.createElement(C.a,{hover:!0},r.a.createElement(x.a,{className:P()(t.cell,t.expandCollapseCell),onClick:e.toggleExpand(a.hostname)},l[a.hostname]?r.a.createElement(D.a,{className:t.expandCollapseIcon}):r.a.createElement(B.a,{className:t.expandCollapseIcon})),r.a.createElement(x.a,{className:t.cell},a.hostname),r.a.createElement(x.a,{className:t.cell},a.workers.length),r.a.createElement(x.a,{className:t.cell},$(a.boot_time)),r.a.createElement(x.a,{className:t.cell},r.a.createElement("div",{className:t.cpuUsage},r.a.createElement(q,{percent:a.cpu,text:"".concat(a.cpu.toFixed(1),"%")}))),r.a.createElement(x.a,{className:t.cell},r.a.createElement(q,{percent:100*(a.mem[0]-a.mem[1])/a.mem[0],text:Z(a.mem[0]-a.mem[1],a.mem[0],"gibibyte")})),r.a.createElement(x.a,{className:t.cell},r.a.createElement(q,{percent:100*a.disk["/"].used/a.disk["/"].total,text:Z(a.disk["/"].used,a.disk["/"].total,"gibibyte")})),r.a.createElement(x.a,{className:t.cell},0===i[a.hostname].total?r.a.createElement("span",{className:t.secondary},"No logs"):r.a.createElement(y.a,{component:d.b,to:"/logs/".concat(a.hostname)},"View all logs (",i[a.hostname].total.toLocaleString()," ",1===i[a.hostname].total?"line":"lines",")")),r.a.createElement(x.a,{className:t.cell},0===m[a.hostname].total?r.a.createElement("span",{className:t.secondary},"No errors"):r.a.createElement(y.a,{component:d.b,to:"/errors/".concat(a.hostname)},"View all errors (",m[a.hostname].total.toLocaleString(),")"))),l[a.hostname]&&a.workers.map(function(e,n){return r.a.createElement(C.a,{hover:!0,key:n},r.a.createElement(x.a,{className:t.cell}),r.a.createElement(x.a,{className:t.cell},e.cmdline[0].split(":",2)[0]," (PID:"," ",e.pid,")"),r.a.createElement(x.a,{className:t.cell},e.cmdline[0].split(":",2)[1]||r.a.createElement("span",{className:t.secondary},"Idle")),r.a.createElement(x.a,{className:t.cell},$(e.create_time)),r.a.createElement(x.a,{className:t.cell},r.a.createElement(q,{percent:e.cpu_percent,text:"".concat(e.cpu_percent.toFixed(1),"%")})),r.a.createElement(x.a,{className:t.cell},r.a.createElement(q,{percent:100*e.memory_info.rss/a.mem[0],text:Y(e.memory_info.rss,"mebibyte")})),r.a.createElement(x.a,{className:t.cell},r.a.createElement("span",{className:t.secondary},"Not available")),r.a.createElement(x.a,{className:t.cell},0===i[a.hostname].perWorker[e.pid]?r.a.createElement("span",{className:t.secondary},"No logs"):r.a.createElement(y.a,{component:d.b,to:"/logs/".concat(a.hostname,"/").concat(e.pid)},"View log (",i[a.hostname].perWorker[e.pid].toLocaleString()," ",1===i[a.hostname].perWorker[e.pid]?"line":"lines",")")),r.a.createElement(x.a,{className:t.cell},0===m[a.hostname].perWorker[e.pid]?r.a.createElement("span",{className:t.secondary},"No errors"):r.a.createElement(y.a,{component:d.b,to:"/errors/".concat(a.hostname,"/").concat(e.pid)},"View errors (",m[a.hostname].perWorker[e.pid].toLocaleString(),")")))}))}))),r.a.createElement(S.a,{align:"center"},"Last updated: ",new Date(1e3*s).toLocaleString()),r.a.createElement(L.a,{path:"/logs/:hostname/:pid?",render:function(e){return r.a.createElement(G,Object.assign({},e,{ipToHostname:ue,logs:c.logs}))}}),r.a.createElement(L.a,{path:"/errors/:hostname/:pid?",render:function(e){return r.a.createElement(z,Object.assign({},e,{errors:c.errors}))}}))}}]),t}(r.a.Component),te=j()(function(e){return E()({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(2)}},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},cpuUsage:{minWidth:60},secondary:{color:e.palette.text.secondary}})})(ee),ae=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement(u.a,null),r.a.createElement(te,null))}}]),t}(r.a.Component);l.a.render(r.a.createElement(ae,null),document.getElementById("root"))},80:function(e,t,a){e.exports=a(110)}},[[80,1,2]]]);
//# sourceMappingURL=main.04137d81.chunk.js.map